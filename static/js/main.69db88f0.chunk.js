(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{17:function(e,t,s){},21:function(e,t,s){},23:function(e,t,s){},24:function(e,t,s){},25:function(e,t,s){},26:function(e,t,s){},27:function(e,t,s){"use strict";s.r(t);var i,n,a=s(0),o=s.n(a),u=s(8),h=s.n(u),r=(s(17),s(3)),c=s(5),l=s(12),b=s(4),d=s(2),f=s(10),v=s.n(f),m=s(11),j=s(6);function g(e,t,s){return t*s+e}function O(e){var t=e.min,s=e.max;return Math.floor(Math.random()*(s-t+1))+t}function x(e,t,s){var i=Math.floor(e/t),n=e-i*t,a=t-1,o=s-1,u=[];return i>0&&n>0&&u.push(g(n-1,i-1,t)),i>0&&u.push(g(n,i-1,t)),i>0&&n<a&&u.push(g(n+1,i-1,t)),n>0&&u.push(g(n-1,i,t)),n<a&&u.push(g(n+1,i,t)),i<o&&n>0&&u.push(g(n-1,i+1,t)),i<o&&u.push(g(n,i+1,t)),i<o&&n<a&&u.push(g(n+1,i+1,t)),u}!function(e){e[e.MENU=0]="MENU",e[e.PLAYING=1]="PLAYING",e[e.WON=2]="WON",e[e.LOST=3]="LOST"}(i||(i={})),function(e){e[e.INITIAL=0]="INITIAL",e[e.OPEN=1]="OPEN",e[e.FLAGGED=2]="FLAGGED"}(n||(n={}));var p=function(){function e(t){Object(b.a)(this,e),this.queue=[],this.size=void 0,this.frontIdx=void 0,this.backIdx=void 0,this.size=t,this.frontIdx=t-1,this.backIdx=t-1}return Object(j.a)(e,[{key:"enQueue",value:function(e){return!this.isFull()&&(this.queue[this.backIdx]=e,this.backIdx-=1,-1===this.backIdx&&(this.backIdx+=this.size),!0)}},{key:"deQueue",value:function(){return!this.isEmpty()&&(this.queue[this.frontIdx]=void 0,this.frontIdx-=1,-1===this.frontIdx&&(this.frontIdx+=this.size),!0)}},{key:"front",value:function(){var e=this.queue[this.frontIdx];return void 0===e?-1:e}},{key:"rear",value:function(){var e=this.backIdx+1;e===this.size&&(e-=this.size);var t=this.queue[e];return void 0===t?-1:t}},{key:"isEmpty",value:function(){return this.frontIdx===this.backIdx&&void 0===this.queue[this.frontIdx]}},{key:"isFull",value:function(){return this.frontIdx===this.backIdx&&void 0!==this.queue[this.frontIdx]}}]),e}(),I=function(){function e(){Object(b.a)(this,e),this.status=n.INITIAL,this.hasBomb=void 0,Object(d.f)(this,{status:d.g,open:d.b})}return Object(j.a)(e,[{key:"open",value:function(){this.status=n.OPEN}},{key:"toggleFlag",value:function(e){return e&&this.status===n.INITIAL?(this.status=n.FLAGGED,1):this.status===n.FLAGGED?(this.status=n.INITIAL,-1):0}}]),e}(),N=function(){function e(t,s,i,n,a){var o=this,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:O;Object(b.a)(this,e),this.width=t,this.height=s,this.bombsTotal=i,this.onWin=n,this.onLoose=a,this.randomNumberGenerator=u,this.cells=void 0,this.cellsToOpen=void 0,this.cellsLeftToPlaceBombs=void 0,this.bombsToPlace=void 0,this.flagsPlaced=0,this.hasBomb=function(e){var t=o.getCell(e);return void 0===t.hasBomb&&(t.hasBomb=o.shouldHaveBomb()),t.hasBomb},this.queue=new p(this.width*this.height),this.isOpeningRecursively=!1,this.cells=[],this.cellsLeftToPlaceBombs=this.width*this.height,this.cellsToOpen=this.width*this.height-this.bombsTotal,this.bombsToPlace=this.bombsTotal,Object(d.f)(this,{cellsToOpen:d.g,flagsPlaced:d.g,flagsLeft:d.c,toggleFlag:d.b,openCell:d.b})}return Object(j.a)(e,[{key:"flagsLeft",get:function(){return this.bombsTotal-this.flagsPlaced}},{key:"getCell",value:function(e){if(!this.cells[e]){var t=new I;return this.cells[e]=t,t}return this.cells[e]}},{key:"getCellByCoords",value:function(e,t){var s=g(e,t,this.width);return this.getCell(s)}},{key:"toggleFlag",value:function(e,t){var s=g(e,t,this.width),i=this.cells[s];this.flagsPlaced+=i.toggleFlag(this.flagsPlaced<this.bombsTotal)}},{key:"openCell",value:function(e){e.open(),this.cellsToOpen-=1,0===this.cellsToOpen&&this.onWin()}},{key:"getValue",value:function(e){return this.hasBomb(e)?-1:(t=e,s=this.width,i=this.height,n=this.hasBomb,x(t,s,i).reduce((function(e,t){return e+(n(t)?1:0)}),0));var t,s,i,n}},{key:"getValueByCoords",value:function(e,t){var s=g(e,t,this.width);return this.getValue(s)}},{key:"shouldHaveBomb",value:function(){if(this.cellsLeftToPlaceBombs===this.width*this.height)return this.cellsLeftToPlaceBombs-=1,!1;var e=this.randomNumberGenerator({min:1,max:this.cellsLeftToPlaceBombs})<=this.bombsToPlace;return e&&(this.bombsToPlace-=1),this.cellsLeftToPlaceBombs-=1,e}},{key:"open",value:function(e,t){var s=t*this.width+e,i=this.cells[s];this.openCell(i);var n=this.getValue(s);-1===n&&this.onLoose(),0===n&&(this.queue.enQueue(s),this.openRecursive())}},{key:"openRecursive",value:function(){var e=Object(m.a)(v.a.mark((function e(){var t,s,i=this;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isOpeningRecursively){e.next=2;break}return e.abrupt("return");case 2:this.isOpeningRecursively=!0,t=0;case 4:if(-1===this.queue.front()){e.next=15;break}if(t+=1,s=this.queue.front(),this.queue.deQueue(),x(s,this.width,this.height).forEach((function(e){var t=i.cells[e];t.status===n.INITIAL&&(i.openCell(t),0===i.getValue(e)&&i.queue.enQueue(e))})),100!==t){e.next=13;break}return t=0,e.next=13,new Promise((function(e){return setTimeout(e,0)}));case 13:e.next=4;break;case 15:this.isOpeningRecursively=!1;case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),y=new function e(){var t=this;Object(b.a)(this,e),this.state=i.MENU,this.gameField=void 0,this.resetGame=function(){var e=t.gameField,s=e.width,n=e.height,a=e.bombsTotal;t.state=i.PLAYING,t.gameField=new N(s,n,a,t.handleWin,t.handleLoose)},this.handleWin=function(){t.state===i.PLAYING&&(t.state=i.WON)},this.handleLoose=function(){t.state=i.LOST},this.startGame=function(e){t.state=i.PLAYING,t.gameField=new N(e.width,e.height,e.bombs,t.handleWin,t.handleLoose)},Object(d.f)(this,{state:d.g,gameField:d.g,startGame:d.b,resetGame:d.b,handleWin:d.b,handleLoose:d.b})},L=o.a.createContext(y),k=(s(21),s(1)),T=Object(r.cn)("cell"),w=Object(c.a)((function(e){var t=e.columnIndex,s=e.rowIndex,a=e.style,u=o.a.useContext(L),h=u.state,r=u.gameField,c=r.getCellByCoords(t,s).status,l=o.a.useMemo((function(){if(c===n.OPEN||h===i.LOST)return r.getValueByCoords(t,s)}),[t,s,r,c,h]);return Object(k.jsx)("div",{className:T({value:l,status:c}),style:a,onMouseDown:function(e){if(h===i.PLAYING)if(0!==e.button)r.toggleFlag(t,s);else{if(c!==n.INITIAL)return;r.open(t,s)}},onContextMenu:function(e){e.preventDefault()},children:-1!==l&&0!==l&&l})})),C=(s(23),Object(r.cn)("game-field")),P=Object(c.a)((function(){var e=o.a.useContext(L).gameField,t=e.width,s=e.height;return Object(k.jsx)(l.a,{className:C(),columnCount:t,columnWidth:16,height:600,rowCount:s,rowHeight:16,width:1024,children:w})})),F=(s(24),Object(r.cn)("header")),G=Object(c.a)((function(){var e=o.a.useContext(L),t=e.state,s=e.gameField,n=s.flagsLeft,a=s.cellsToOpen;return Object(k.jsxs)("div",{className:F(),children:[Object(k.jsxs)("div",{className:F("stats"),children:[Object(k.jsxs)("div",{children:["Flags left: ",n]}),Object(k.jsxs)("div",{children:["Cells to open: ",a]})]}),Object(k.jsx)("div",{children:Object(k.jsx)("button",{onClick:e.resetGame,children:t===i.WON?"\ud83d\ude0e":t===i.LOST?"\u2639\ufe0f":"\ud83d\ude42"})})]})})),B=s(7),E=function(e){return/^\d+$/.test(e)},A=function(e){return function(t){return+t>=e}},S=function(e){return function(t){return+t<=e}},q={width:[E,A(1),S(1e4)],height:[E,A(1),S(1e4)],bombs:[E,A(1),function(e,t){var s=t.width,i=t.height;return S(Number(s)*Number(i)-1)(e)}]},M={width:"Number from 1 to 10000",height:"Number from 1 to 10000",bombs:"Number from 1 to (cells - 1)"},W=(s(25),Object(r.cn)("menu")),D=function(e){var t=e.onStartGame,s=Object(a.useState)("9"),i=Object(B.a)(s,2),n=i[0],o=i[1],u=Object(a.useState)("9"),h=Object(B.a)(u,2),r=h[0],c=h[1],l=Object(a.useState)("10"),b=Object(B.a)(l,2),d=b[0],f=b[1],v=Object(a.useState)({}),m=Object(B.a)(v,2),j=m[0],g=m[1];return Object(k.jsxs)("form",{onSubmit:function(e){e.preventDefault();var s=function(e){return Object.keys(e).reduce((function(t,s){return q[s].some((function(t){return!t(e[s],e)}))&&(t[s]=M[s]),t}),{})}({width:n,height:r,bombs:d});g(s),0===Object.keys(s).length&&t({width:+n,height:+r,bombs:+d})},children:[Object(k.jsx)("div",{children:Object(k.jsx)("label",{children:"Width"})}),Object(k.jsx)("input",{type:"text",value:n,onChange:function(e){return o(e.target.value)}}),Object(k.jsx)("div",{className:W("error"),children:j.width}),Object(k.jsx)("div",{children:Object(k.jsx)("label",{children:"Height"})}),Object(k.jsx)("input",{type:"text",value:r,onChange:function(e){return c(e.target.value)}}),Object(k.jsx)("div",{className:W("error"),children:j.height}),Object(k.jsx)("div",{children:Object(k.jsx)("label",{children:"Bombs"})}),Object(k.jsx)("input",{type:"text",value:d,onChange:function(e){return f(e.target.value)}}),Object(k.jsx)("div",{className:W("error"),children:j.bombs}),Object(k.jsx)("input",{className:W("submit"),type:"submit",value:"Let's go!"})]})},z=(s(26),Object(r.cn)("app")),R=Object(c.a)((function(){var e=o.a.useContext(L);return Object(k.jsxs)("div",{className:z(),children:[Object(k.jsx)("h1",{children:"HUGE Minesweeper"}),e.state===i.MENU&&Object(k.jsx)(D,{onStartGame:e.startGame}),e.state!==i.MENU&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(G,{}),Object(k.jsx)(P,{})]})]})})),U=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,28)).then((function(t){var s=t.getCLS,i=t.getFID,n=t.getFCP,a=t.getLCP,o=t.getTTFB;s(e),i(e),n(e),a(e),o(e)}))};h.a.render(Object(k.jsx)(o.a.StrictMode,{children:Object(k.jsx)(L.Provider,{value:y,children:Object(k.jsx)(R,{})})}),document.getElementById("root")),U()}},[[27,1,2]]]);
//# sourceMappingURL=main.69db88f0.chunk.js.map