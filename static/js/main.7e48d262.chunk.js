(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{17:function(t,e,s){},21:function(t,e,s){},23:function(t,e,s){},24:function(t,e,s){},25:function(t,e,s){},26:function(t,e,s){},27:function(t,e,s){"use strict";s.r(e);var i,n,a=s(0),o=s.n(a),u=s(8),h=s.n(u),c=(s(17),s(3)),r=s(5),l=s(12),b=s(4),d=s(2),f=s(10),v=s.n(f),m=s(11),j=s(6);function g(t,e,s){return e*s+t}function O(t){var e=t.min,s=t.max;return Math.floor(Math.random()*(s-e+1))+e}function x(t,e,s){var i=Math.floor(t/e),n=t-i*e,a=e-1,o=s-1,u=[];return i>0&&n>0&&u.push(g(n-1,i-1,e)),i>0&&u.push(g(n,i-1,e)),i>0&&n<a&&u.push(g(n+1,i-1,e)),n>0&&u.push(g(n-1,i,e)),n<a&&u.push(g(n+1,i,e)),i<o&&n>0&&u.push(g(n-1,i+1,e)),i<o&&u.push(g(n,i+1,e)),i<o&&n<a&&u.push(g(n+1,i+1,e)),u}!function(t){t[t.MENU=0]="MENU",t[t.PLAYING=1]="PLAYING",t[t.WON=2]="WON",t[t.LOST=3]="LOST"}(i||(i={})),function(t){t[t.INITIAL=0]="INITIAL",t[t.OPEN=1]="OPEN",t[t.FLAGGED=2]="FLAGGED"}(n||(n={}));var p=function(){function t(e){Object(b.a)(this,t),this.queue=[],this.size=void 0,this.frontIdx=void 0,this.backIdx=void 0,this.size=e,this.frontIdx=e-1,this.backIdx=e-1}return Object(j.a)(t,[{key:"enQueue",value:function(t){return!this.isFull()&&(this.queue[this.backIdx]=t,this.backIdx-=1,-1===this.backIdx&&(this.backIdx+=this.size),!0)}},{key:"deQueue",value:function(){return!this.isEmpty()&&(this.queue[this.frontIdx]=void 0,this.frontIdx-=1,-1===this.frontIdx&&(this.frontIdx+=this.size),!0)}},{key:"front",value:function(){var t=this.queue[this.frontIdx];return void 0===t?-1:t}},{key:"rear",value:function(){var t=this.backIdx+1;t===this.size&&(t-=this.size);var e=this.queue[t];return void 0===e?-1:e}},{key:"isEmpty",value:function(){return this.frontIdx===this.backIdx&&void 0===this.queue[this.frontIdx]}},{key:"isFull",value:function(){return this.frontIdx===this.backIdx&&void 0!==this.queue[this.frontIdx]}}]),t}(),I=function(){function t(){Object(b.a)(this,t),this.status=n.INITIAL,this.hasBomb=void 0,Object(d.f)(this,{status:d.g,open:d.b})}return Object(j.a)(t,[{key:"open",value:function(){this.status=n.OPEN}},{key:"toggleFlag",value:function(t){return t&&this.status===n.INITIAL?(this.status=n.FLAGGED,1):this.status===n.FLAGGED?(this.status=n.INITIAL,-1):0}}]),t}(),N=function(){function t(e,s,i,n,a){var o=this,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:O;Object(b.a)(this,t),this.width=e,this.height=s,this.bombsTotal=i,this.onWin=n,this.onLoose=a,this.randomNumberGenerator=u,this.cells=void 0,this.cellsToOpen=void 0,this.cellsLeftToPlaceBombs=void 0,this.bombsToPlace=void 0,this.flagsPlaced=0,this.hasBomb=function(t){var e=o.getCell(t);return void 0===e.hasBomb&&(e.hasBomb=o.shouldHaveBomb()),e.hasBomb},this.queue=new p(this.width*this.height),this.isOpeningRecursively=!1,this.cells=[],this.cellsLeftToPlaceBombs=this.width*this.height,this.cellsToOpen=this.width*this.height-this.bombsTotal,this.bombsToPlace=this.bombsTotal,Object(d.f)(this,{cellsToOpen:d.g,flagsPlaced:d.g,flagsLeft:d.c,toggleFlag:d.b,openCell:d.b})}return Object(j.a)(t,[{key:"flagsLeft",get:function(){return this.bombsTotal-this.flagsPlaced}},{key:"getCell",value:function(t){if(!this.cells[t]){var e=new I;return this.cells[t]=e,e}return this.cells[t]}},{key:"getCellByCoords",value:function(t,e){var s=g(t,e,this.width);return this.getCell(s)}},{key:"toggleFlag",value:function(t,e){var s=g(t,e,this.width),i=this.cells[s];this.flagsPlaced+=i.toggleFlag(this.flagsPlaced<this.bombsTotal)}},{key:"openCell",value:function(t){t.open(),this.cellsToOpen-=1,0===this.cellsToOpen&&this.onWin()}},{key:"getValue",value:function(t){return this.hasBomb(t)?-1:(e=t,s=this.width,i=this.height,n=this.hasBomb,x(e,s,i).reduce((function(t,e){return t+(n(e)?1:0)}),0));var e,s,i,n}},{key:"getValueByCoords",value:function(t,e){var s=g(t,e,this.width);return this.getValue(s)}},{key:"shouldHaveBomb",value:function(){if(this.cellsLeftToPlaceBombs===this.width*this.height)return this.cellsLeftToPlaceBombs-=1,!1;var t=this.randomNumberGenerator({min:1,max:this.cellsLeftToPlaceBombs})<=this.bombsToPlace;return t&&(this.bombsToPlace-=1),this.cellsLeftToPlaceBombs-=1,t}},{key:"open",value:function(t,e){var s=e*this.width+t,i=this.cells[s];this.openCell(i);var n=this.getValue(s);-1===n&&this.onLoose(),0===n&&(this.queue.enQueue(s),this.openRecursive())}},{key:"openRecursive",value:function(){var t=Object(m.a)(v.a.mark((function t(){var e,s,i=this;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isOpeningRecursively){t.next=2;break}return t.abrupt("return");case 2:this.isOpeningRecursively=!0,e=0;case 4:if(-1===this.queue.front()){t.next=15;break}if(e+=1,s=this.queue.front(),this.queue.deQueue(),x(s,this.width,this.height).forEach((function(t){var e=i.cells[t];e.status===n.INITIAL&&(i.openCell(e),0===i.getValue(t)&&i.queue.enQueue(t))})),100!==e){t.next=13;break}return e=0,t.next=13,new Promise((function(t){return setTimeout(t,0)}));case 13:t.next=4;break;case 15:this.isOpeningRecursively=!1;case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),y=new function t(){var e=this;Object(b.a)(this,t),this.state=i.MENU,this.gameField=void 0,this.resetGame=function(){var t=e.gameField,s=t.width,n=t.height,a=t.bombsTotal;e.state=i.PLAYING,e.gameField=new N(s,n,a,e.handleWin,e.handleLoose)},this.handleWin=function(){e.state===i.PLAYING&&(e.state=i.WON)},this.handleLoose=function(){e.state=i.LOST},this.startGame=function(t){e.state=i.PLAYING,e.gameField=new N(t.width,t.height,t.bombs,e.handleWin,e.handleLoose)},Object(d.f)(this,{state:d.g,gameField:d.g,startGame:d.b,resetGame:d.b,handleWin:d.b,handleLoose:d.b})},L=o.a.createContext(y),k=(s(21),s(1)),T=Object(c.cn)("cell"),w=Object(r.a)((function(t){var e=t.columnIndex,s=t.rowIndex,a=t.style,u=o.a.useContext(L),h=u.state,c=u.gameField,r=c.getCellByCoords(e,s).status,l=o.a.useMemo((function(){if(r===n.OPEN||h===i.LOST)return c.getValueByCoords(e,s)}),[e,s,c,r,h]);return Object(k.jsx)("div",{className:T({value:"v".concat(l),status:"s".concat(r)}),style:a,onMouseDown:function(t){if(h===i.PLAYING)if(0!==t.button)c.toggleFlag(e,s);else{if(r!==n.INITIAL)return;c.open(e,s)}},onContextMenu:function(t){t.preventDefault()},children:-1!==l&&0!==l&&l})})),C=(s(23),Object(c.cn)("game-field")),P=Object(r.a)((function(){var t=o.a.useContext(L).gameField,e=t.width,s=t.height;return Object(k.jsx)(l.a,{className:C(),columnCount:e,columnWidth:16,height:600,rowCount:s,rowHeight:16,width:1024,children:w})})),F=(s(24),Object(c.cn)("header")),G=Object(r.a)((function(){var t=o.a.useContext(L),e=t.state,s=t.gameField,n=s.flagsLeft,a=s.cellsToOpen;return Object(k.jsxs)("div",{className:F(),children:[Object(k.jsxs)("div",{className:F("stats"),children:[Object(k.jsxs)("div",{children:["Flags left: ",n]}),Object(k.jsxs)("div",{children:["Cells to open: ",a]})]}),Object(k.jsx)("div",{children:Object(k.jsx)("button",{onClick:t.resetGame,children:e===i.WON?"\ud83d\ude0e":e===i.LOST?"\u2639\ufe0f":"\ud83d\ude42"})})]})})),B=s(7),E=function(t){return/^\d+$/.test(t)},A=function(t){return function(e){return+e>=t}},S=function(t){return function(e){return+e<=t}},q={width:[E,A(1),S(1e4)],height:[E,A(1),S(1e4)],bombs:[E,A(1),function(t,e){var s=e.width,i=e.height;return S(Number(s)*Number(i)-1)(t)}]},M={width:"Number from 1 to 10000",height:"Number from 1 to 10000",bombs:"Number from 1 to (cells - 1)"},W=(s(25),Object(c.cn)("menu")),D=function(t){var e=t.onStartGame,s=Object(a.useState)("9"),i=Object(B.a)(s,2),n=i[0],o=i[1],u=Object(a.useState)("9"),h=Object(B.a)(u,2),c=h[0],r=h[1],l=Object(a.useState)("10"),b=Object(B.a)(l,2),d=b[0],f=b[1],v=Object(a.useState)({}),m=Object(B.a)(v,2),j=m[0],g=m[1];return Object(k.jsxs)("form",{onSubmit:function(t){t.preventDefault();var s=function(t){return Object.keys(t).reduce((function(e,s){return q[s].some((function(e){return!e(t[s],t)}))&&(e[s]=M[s]),e}),{})}({width:n,height:c,bombs:d});g(s),0===Object.keys(s).length&&e({width:+n,height:+c,bombs:+d})},children:[Object(k.jsx)("div",{children:Object(k.jsx)("label",{children:"Width"})}),Object(k.jsx)("input",{type:"text",value:n,onChange:function(t){return o(t.target.value)}}),Object(k.jsx)("div",{className:W("error"),children:j.width}),Object(k.jsx)("div",{children:Object(k.jsx)("label",{children:"Height"})}),Object(k.jsx)("input",{type:"text",value:c,onChange:function(t){return r(t.target.value)}}),Object(k.jsx)("div",{className:W("error"),children:j.height}),Object(k.jsx)("div",{children:Object(k.jsx)("label",{children:"Bombs"})}),Object(k.jsx)("input",{type:"text",value:d,onChange:function(t){return f(t.target.value)}}),Object(k.jsx)("div",{className:W("error"),children:j.bombs}),Object(k.jsx)("input",{className:W("submit"),type:"submit",value:"Let's go!"})]})},z=(s(26),Object(c.cn)("app")),R=Object(r.a)((function(){var t=o.a.useContext(L);return Object(k.jsxs)("div",{className:z(),children:[Object(k.jsx)("h1",{children:"HUGE Minesweeper"}),t.state===i.MENU&&Object(k.jsx)(D,{onStartGame:t.startGame}),t.state!==i.MENU&&Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(G,{}),Object(k.jsx)(P,{})]})]})})),U=function(t){t&&t instanceof Function&&s.e(3).then(s.bind(null,28)).then((function(e){var s=e.getCLS,i=e.getFID,n=e.getFCP,a=e.getLCP,o=e.getTTFB;s(t),i(t),n(t),a(t),o(t)}))};h.a.render(Object(k.jsx)(o.a.StrictMode,{children:Object(k.jsx)(L.Provider,{value:y,children:Object(k.jsx)(R,{})})}),document.getElementById("root")),U()}},[[27,1,2]]]);
//# sourceMappingURL=main.7e48d262.chunk.js.map